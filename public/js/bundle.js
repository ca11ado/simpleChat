(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 08.11.2015.
 */

var SChatDispatcher = require('../dispatcher/SChatDispatcher'),
    SChatConstants = require('../constants/SChatConstants');

module.exports = {
    updateListOfUsers: function updateListOfUsers(newList) {
        SChatDispatcher.dispatch({
            actionType: SChatConstants.ACTIVATE_LOGIN_FORM,
            list: newList
        });
    },
    connectedToWebSocket: function connectedToWebSocket() {
        SChatDispatcher.dispatch({
            actionType: SChatConstants.CONN_OPEN
        });
    },
    authorized: function authorized(userName) {
        SChatDispatcher.dispatch({
            actionType: SChatConstants.AUTHORIZED,
            userName: userName
        });
    }
};

},{"../constants/SChatConstants":7,"../dispatcher/SChatDispatcher":8}],2:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 06.11.2015.
 */

var chat = require('./chat/chat');
var ws = require('./chat/websocket');
var dispatcher = require('./dispatcher/SChatDispatcher');
var component = require('./components/SChatComponent'),
    SChatUsersStore = require('./stores/SChatUsersStore');

console.log('start app');

ws.connect('ws://localhost:8080');

ws.onMsg('myMsg', function (data) {
  console.log('New myMsg message', data);
});

setTimeout(function () {
  ws.sendTestMsg('test message from app');
}, 2000);

},{"./chat/chat":3,"./chat/websocket":5,"./components/SChatComponent":6,"./dispatcher/SChatDispatcher":8,"./stores/SChatUsersStore":10}],3:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 06.11.2015.
 */

var ws = require('./websocket.js');
var dispatcher = require('../dispatcher/SChatDispatcher');

setTimeout(function () {
  ws.sendTestMsg('test message from chat');
}, 2000);

module.exports = [{
  name: 't0s',
  messages: 10
}, {
  name: 'test',
  messages: 5
}];

},{"../dispatcher/SChatDispatcher":8,"./websocket.js":5}],4:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 07.11.2015.
 */

/*let button = document.getElementById('button');
button.onclick = function(e){
    console.log('button', e);
};*/

var Interface = {
    showSection: function showSection(section) {
        var sections = document.getElementsByClassName('mainSection'),
            activateSection = document.getElementById(section);
        console.log('Sections %o %o', section, sections.length);
        for (var i = 0; i < sections.length; i++) {
            sections[i].hidden = true;
        }
        /*sections.map(function (v) {
            v.hidden = true;
        });*/
        activateSection.hidden = false;
    }
};

module.exports = Interface;

},{}],5:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 07.11.2015.
 */
var SChatActions = require('../actions/SChatActions');

var _socket = undefined,
    _events = {};
var WS_TYPE_NEW = 'new',
    WS_TYPE_MSG = "message";

function message(type, data) {
  switch (type) {
    case types.NEW:
      return { type: types.NEW, login: data.login };
      break;
    case types.MESSAGE:
      return { type: types.MESSAGE, login: data.login, msg: data.msg, time: data.time };
      break;
    default:
    //nothing
  }
}

var WS = {

  connect: function connect(url) {
    console.log('starting ws');
    if (_socket) return Error('Уже есть соединение');

    _socket = new WebSocket(url);

    _socket.onopen = function () {
      SChatActions.connectedToWebSocket();
      setTimeout(function () {
        _socket.send('New test user');
      }, 2000);
    };
    _socket.onclose = function (event) {
      console.log('Код: ' + event.code + ' причина: ' + event.reason);
    };
    _socket.onmessage = function (event) {
      console.log("f:websocket > получены данные " + event.data);
      SChatActions.authorized('Test');
    };
    _socket.onerror = function (error) {
      console.log("Ошибка " + error.message);
    };

    return _socket;
  },

  getSocket: function getSocket() {
    return _socket;
  },

  onMsg: function onMsg(event, callback) {
    _events[event] = _events[event] ? _events[event].push(callback) : [];
  },

  emitMsg: function emitMsg(event, arg) {
    if (_events.hasOwnProperty(event)) {
      _events[event].map(function (v) {
        v(arg);
      });
    }
  },

  sendTestMsg: function sendTestMsg(txt) {
    _socket.send(txt);
  }

};

module.exports = WS;

},{"../actions/SChatActions":1}],6:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 08.11.2015.
 */

var ChatInterface = require('../chat/interface');

var SChatActions = require('../actions/SChatActions'),
    SChatUsersStore = require('../stores/SChatUsersStore'),
    SChatSectionsStore = require('../stores/SChatSectionsStore');

SChatUsersStore.addChangeListener(function () {
    console.log('Component retrieve data from store');
});

SChatSectionsStore.addChangeListener(function () {
    console.log('f:SChatComponent > Activate section: ', SChatSectionsStore.getActiveSection());
    ChatInterface.showSection(SChatSectionsStore.getActiveSection());
});

module.exports = setTimeout(function () {
    SChatActions.updateListOfUsers(['user1', 'user2']);
}, 2000);

},{"../actions/SChatActions":1,"../chat/interface":4,"../stores/SChatSectionsStore":9,"../stores/SChatUsersStore":10}],7:[function(require,module,exports){
"use strict";

/**
 * Created by tos on 08.11.2015.
 */

function keyMirror(obj) {
    for (var key in obj) {
        if (obj.hasOwnProperty(key)) obj[key] = key;
    }
    return obj;
}

var SChatConstants = keyMirror({
    CONN_OPEN: null,
    AUTHORIZED: null,
    UPDATE_USERS_LIST: null
});

module.exports = SChatConstants;

},{}],8:[function(require,module,exports){
"use strict";

/**
 * Created by tos on 08.11.2015.
 */

var _callbacks = [];

module.exports = {
    register: function register(callback) {
        _callbacks.push(callback);
    },
    dispatch: function dispatch(action) {
        _callbacks.map(function (v) {
            v(action);
        });
    }
};

},{}],9:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 08.11.2015.
 */

var SChatDispatcher = require('../dispatcher/SChatDispatcher'),
    SChatConstants = require('../constants/SChatConstants'),
    Emitter = require('./emiter');

var CHANGE_EVENT = 'change',
    SECTION_LOGIN = 'login',
    SECTION_CHAT = 'chat';

var _sections = {
    SECTION_LOGIN: false,
    SECTION_CHAT: false
};

function activateSection(section) {
    for (var key in _sections) {
        if (_sections.hasOwnProperty(key)) _sections[key] = false;
        _sections[section] = true;
    }
}

var SChatSectionsStore = Object.assign({}, Emitter.prototype, {
    addChangeListener: function addChangeListener(callback) {
        this.addMyListener(CHANGE_EVENT, callback);
    },

    getActiveSection: function getActiveSection() {
        for (var key in _sections) {
            if (_sections.hasOwnProperty(key) && _sections[key]) return key;
        }
    }
});

SChatDispatcher.register(function (action) {
    console.log('DISPATCHER registered in SChatSectionsStore');
    switch (action.actionType) {
        case SChatConstants.CONN_OPEN:
            activateSection(SECTION_LOGIN);
            SChatSectionsStore.emit(CHANGE_EVENT);
            break;
        case SChatConstants.AUTHORIZED:
            activateSection(SECTION_CHAT);
            SChatSectionsStore.emit(CHANGE_EVENT);
            break;
        default:
        //nothing
    }
});

module.exports = SChatSectionsStore;

},{"../constants/SChatConstants":7,"../dispatcher/SChatDispatcher":8,"./emiter":11}],10:[function(require,module,exports){
'use strict';

/**
 * Created by tos on 08.11.2015.
 */

var SChatDispatcher = require('../dispatcher/SChatDispatcher'),
    SChatConstants = require('../constants/SChatConstants'),
    Emitter = require('./emiter');

var CHANGE_EVENT = 'change';
var _users = [];

function updateUsers(newUsers) {
    _users = newUsers;
}

var SChatUsersStore = Object.assign({}, Emitter.prototype, {
    addChangeListener: function addChangeListener(callback) {
        this.addMyListener(CHANGE_EVENT, callback);
    }
});

SChatDispatcher.register(function (action) {
    console.log('DISPATCHER registered in SChatUsersStore');
    switch (action.actionType) {
        case SChatConstants.ACTIVATE_LOGIN_FORM:
            //SChatUsersStore.emit(CHANGE_EVENT);
            break;
        default:
        //nothing
    }
});

module.exports = SChatUsersStore;

},{"../constants/SChatConstants":7,"../dispatcher/SChatDispatcher":8,"./emiter":11}],11:[function(require,module,exports){
"use strict";

/**
 * Created by tos on 08.11.2015.
 */

var Emitter = function Emitter() {};

Emitter.prototype.addMyListener = function (event, listener) {
    if (!this._events) this._events = {};
    if (!this._events.hasOwnProperty(event)) this._events[event] = [];
    this._events[event].push(listener);
};

Emitter.prototype.emit = function (event, arg) {
    if (this._events && this._events.hasOwnProperty(event)) {
        this._events[event].map(function (v) {
            v(arg);
        });
    }
};

module.exports = Emitter;

},{}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiU0NoYXRBY3Rpb25zLmpzIiwiYXBwLmpzIiwiY2hhdC5qcyIsImludGVyZmFjZS5qcyIsIndlYnNvY2tldC5qcyIsIlNDaGF0Q29tcG9uZW50LmpzIiwiU0NoYXRDb25zdGFudHMuanMiLCJTQ2hhdERpc3BhdGNoZXIuanMiLCJTQ2hhdFNlY3Rpb25zU3RvcmUuanMiLCJTQ2hhdFVzZXJzU3RvcmUuanMiLCJlbWl0ZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUNJQSxJQUFJLGVBQWUsR0FBRyxPQUFPLENBQUMsK0JBQStCLENBQUM7SUFDMUQsY0FBYyxHQUFHLE9BQU8sQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDOztBQUU1RCxNQUFNLENBQUMsT0FBTyxHQUFHO0FBQ2IscUJBQWlCLEVBQUUsMkJBQVMsT0FBTyxFQUFDO0FBQ2xDLHVCQUFlLENBQUMsUUFBUSxDQUFDO0FBQ3JCLHNCQUFVLEVBQUUsY0FBYyxDQUFDLG1CQUFtQjtBQUM5QyxnQkFBSSxFQUFFLE9BQU87U0FDaEIsQ0FBQyxDQUFDO0tBQ0o7QUFDRCx3QkFBb0IsRUFBRSxnQ0FBVTtBQUM1Qix1QkFBZSxDQUFDLFFBQVEsQ0FBQztBQUNyQixzQkFBVSxFQUFFLGNBQWMsQ0FBQyxTQUFTO1NBQ3ZDLENBQUMsQ0FBQztLQUNOO0FBQ0QsY0FBVSxFQUFFLG9CQUFTLFFBQVEsRUFBRTtBQUMzQix1QkFBZSxDQUFDLFFBQVEsQ0FBQztBQUNyQixzQkFBVSxFQUFFLGNBQWMsQ0FBQyxVQUFVO0FBQ3JDLG9CQUFRLEVBQUUsUUFBUTtTQUNyQixDQUFDLENBQUE7S0FDTDtDQUNKLENBQUM7Ozs7Ozs7OztBQ3JCRixJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDbEMsSUFBSSxFQUFFLEdBQUcs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U0FBUyxDQUFDLGFBQWEsR0FBRyxVQUFTLEtBQUssRUFBQyxRQUFRLEVBQUU7QUFDdkQsUUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7QUFDckMsUUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBQ2xFLFFBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0NBQ3RDLENBQUM7O0FBRUYsT0FBTyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEdBQUcsVUFBUyxLQUFLLEVBQUUsR0FBRyxFQUFFO0FBQzFDLFFBQUksSUFBSSxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUNwRCxZQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFTLENBQUMsRUFBRTtBQUNoQyxhQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDVixDQUFDLENBQUE7S0FDTDtDQUNKLENBQUM7O0FBRUYsTUFBTSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgdG9zIG9uIDA4LjExLjIwMTUuXHJcbiAqL1xyXG5cclxubGV0IFNDaGF0RGlzcGF0Y2hlciA9IHJlcXVpcmUoJy4uL2Rpc3BhdGNoZXIvU0NoYXREaXNwYXRjaGVyJyksXHJcbiAgICBTQ2hhdENvbnN0YW50cyA9IHJlcXVpcmUoJy4uL2NvbnN0YW50cy9TQ2hhdENvbnN0YW50cycpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICB1cGRhdGVMaXN0T2ZVc2VyczogZnVuY3Rpb24obmV3TGlzdCl7XHJcbiAgICAgIFNDaGF0RGlzcGF0Y2hlci5kaXNwYXRjaCh7XHJcbiAgICAgICAgICBhY3Rpb25UeXBlOiBTQ2hhdENvbnN0YW50cy5BQ1RJVkFURV9MT0dJTl9GT1JNLFxyXG4gICAgICAgICAgbGlzdDogbmV3TGlzdFxyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBjb25uZWN0ZWRUb1dlYlNvY2tldDogZnVuY3Rpb24oKXtcclxuICAgICAgICBTQ2hhdERpc3BhdGNoZXIuZGlzcGF0Y2goe1xyXG4gICAgICAgICAgICBhY3Rpb25UeXBlOiBTQ2hhdENvbnN0YW50cy5DT05OX09QRU5cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBhdXRob3JpemVkOiBmdW5jdGlvbih1c2VyTmFtZSkge1xyXG4gICAgICAgIFNDaGF0RGlzcGF0Y2hlci5kaXNwYXRjaCh7XHJcbiAgICAgICAgICAgIGFjdGlvblR5cGU6IFNDaGF0Q29uc3RhbnRzLkFVVEhPUklaRUQsXHJcbiAgICAgICAgICAgIHVzZXJOYW1lOiB1c2VyTmFtZVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn07IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgdG9zIG9uIDA2LjExLjIwMTUuXHJcbiAqL1xyXG5cclxubGV0IGNoYXQgPSByZXF1aXJlKCcuL2NoYXQvY2hhdCcpO1xyXG5sZXQgd3MgPSByZXF1aXJlKCcuL2NoYXQvd2Vic29ja2V0Jyk7XHJcbmxldCBkaXNwYXRjaGVyID0gcmVxdWlyZSgnLi9kaXNwYXRjaGVyL1NDaGF0RGlzcGF0Y2hlcicpO1xyXG5sZXQgY29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnRzL1NDaGF0Q29tcG9uZW50JyksXHJcbiAgICBTQ2hhdFVzZXJzU3RvcmUgPSByZXF1aXJlKCcuL3N0b3Jlcy9TQ2hhdFVzZXJzU3RvcmUnKTtcclxuXHJcbmNvbnNvbGUubG9nKCdzdGFydCBhcHAnKTtcclxuXHJcbndzLmNvbm5lY3QoJ3dzOi8vbG9jYWxob3N0OjgwODAnKTtcclxuXHJcbndzLm9uTXNnKCdteU1zZycsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgY29uc29sZS5sb2coJ05ldyBteU1zZyBtZXNzYWdlJywgZGF0YSk7XHJcbn0pO1xyXG5cclxuc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gIHdzLnNlbmRUZXN0TXNnKCd0ZXN0IG1lc3NhZ2UgZnJvbSBhcHAnKTtcclxufSwyMDAwKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSB0b3Mgb24gMDYuMTEuMjAxNS5cclxuICovXHJcblxyXG5sZXQgd3MgPSByZXF1aXJlKCcuL3dlYnNvY2tldC5qcycpO1xyXG5sZXQgZGlzcGF0Y2hlciA9IHJlcXVpcmUoJy4uL2Rpc3BhdGNoZXIvU0NoYXREaXNwYXRjaGVyJyk7XHJcblxyXG5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgd3Muc2VuZFRlc3RNc2coJ3Rlc3QgbWVzc2FnZSBmcm9tIGNoYXQnKTtcclxufSwyMDAwKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6ICd0MHMnLFxyXG4gICAgbWVzc2FnZXM6IDEwXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiAndGVzdCcsXHJcbiAgICBtZXNzYWdlczogNVxyXG4gIH1cclxuXTsiLCIvKipcclxuICogQ3JlYXRlZCBieSB0b3Mgb24gMDcuMTEuMjAxNS5cclxuICovXHJcblxyXG4vKmxldCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uJyk7XHJcbmJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24oZSl7XHJcbiAgICBjb25zb2xlLmxvZygnYnV0dG9uJywgZSk7XHJcbn07Ki9cclxuXHJcblxyXG5sZXQgSW50ZXJmYWNlID0ge1xyXG4gICAgc2hvd1NlY3Rpb246IGZ1bmN0aW9uKHNlY3Rpb24pIHtcclxuICAgICAgICBsZXQgc2VjdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtYWluU2VjdGlvbicpLFxyXG4gICAgICAgICAgICBhY3RpdmF0ZVNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWN0aW9uKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnU2VjdGlvbnMgJW8gJW8nLCBzZWN0aW9uLCBzZWN0aW9ucy5sZW5ndGgpO1xyXG4gICAgICAgIGZvciAobGV0IGk9MDsgaTxzZWN0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBzZWN0aW9uc1tpXS5oaWRkZW4gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKnNlY3Rpb25zLm1hcChmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICB2LmhpZGRlbiA9IHRydWU7XHJcbiAgICAgICAgfSk7Ki9cclxuICAgICAgICBhY3RpdmF0ZVNlY3Rpb24uaGlkZGVuID0gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEludGVyZmFjZTsiLCIvKipcclxuICogQ3JlYXRlZCBieSB0b3Mgb24gMDcuMTEuMjAxNS5cclxuICovXHJcbmxldCBTQ2hhdEFjdGlvbnMgPSByZXF1aXJlKCcuLi9hY3Rpb25zL1NDaGF0QWN0aW9ucycpO1xyXG5cclxubGV0IF9zb2NrZXQsXHJcbiAgICBfZXZlbnRzID0ge307XHJcbmNvbnN0IFdTX1RZUEVfTkVXID0gJ25ldycsXHJcbiAgICAgIFdTX1RZUEVfTVNHID0gXCJtZXNzYWdlXCI7XHJcblxyXG5mdW5jdGlvbiBtZXNzYWdlKHR5cGUsZGF0YSkge1xyXG4gIHN3aXRjaCAodHlwZSkge1xyXG4gICAgY2FzZSB0eXBlcy5ORVc6XHJcbiAgICAgIHJldHVybiB7dHlwZTogdHlwZXMuTkVXLCBsb2dpbjogZGF0YS5sb2dpbn07XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSB0eXBlcy5NRVNTQUdFOlxyXG4gICAgICByZXR1cm4ge3R5cGU6IHR5cGVzLk1FU1NBR0UsIGxvZ2luOmRhdGEubG9naW4sIG1zZzogZGF0YS5tc2csIHRpbWU6IGRhdGEudGltZX07XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdCA6XHJcbiAgICAgIC8vbm90aGluZ1xyXG4gIH1cclxufVxyXG5cclxubGV0IFdTID0ge1xyXG5cclxuICBjb25uZWN0OiBmdW5jdGlvbih1cmwpIHtcclxuICAgIGNvbnNvbGUubG9nKCdzdGFydGluZyB3cycpO1xyXG4gICAgaWYgKF9zb2NrZXQpIHJldHVybiBFcnJvcign0KPQttC1INC10YHRgtGMINGB0L7QtdC00LjQvdC10L3QuNC1Jyk7XHJcblxyXG4gICAgX3NvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuXHJcbiAgICBfc29ja2V0Lm9ub3BlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICBTQ2hhdEFjdGlvbnMuY29ubmVjdGVkVG9XZWJTb2NrZXQoKTtcclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgX3NvY2tldC5zZW5kKCdOZXcgdGVzdCB1c2VyJyk7XHJcbiAgICAgIH0sIDIwMDApO1xyXG4gICAgfTtcclxuICAgIF9zb2NrZXQub25jbG9zZSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNvbnNvbGUubG9nKCfQmtC+0LQ6ICcgKyBldmVudC5jb2RlICsgJyDQv9GA0LjRh9C40L3QsDogJyArIGV2ZW50LnJlYXNvbik7IH07XHJcbiAgICBfc29ja2V0Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiZjp3ZWJzb2NrZXQgPiDQv9C+0LvRg9GH0LXQvdGLINC00LDQvdC90YvQtSBcIiArIGV2ZW50LmRhdGEpO1xyXG4gICAgICBTQ2hhdEFjdGlvbnMuYXV0aG9yaXplZCgnVGVzdCcpO1xyXG4gICAgfTtcclxuICAgIF9zb2NrZXQub25lcnJvciA9IGZ1bmN0aW9uKGVycm9yKSB7IGNvbnNvbGUubG9nKFwi0J7RiNC40LHQutCwIFwiICsgZXJyb3IubWVzc2FnZSk7IH07XHJcblxyXG4gICAgcmV0dXJuIF9zb2NrZXQ7XHJcbiAgfSxcclxuXHJcbiAgZ2V0U29ja2V0OiBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBfc29ja2V0O1xyXG4gIH0sXHJcblxyXG4gIG9uTXNnOiBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spIHtcclxuICAgIF9ldmVudHNbZXZlbnRdID0gX2V2ZW50c1tldmVudF0gPyBfZXZlbnRzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKSA6IFtdO1xyXG4gIH0sXHJcblxyXG4gIGVtaXRNc2c6IGZ1bmN0aW9uKGV2ZW50LCBhcmcpIHtcclxuICAgIGlmIChfZXZlbnRzLmhhc093blByb3BlcnR5KGV2ZW50KSkge1xyXG4gICAgICBfZXZlbnRzW2V2ZW50XS5tYXAoZnVuY3Rpb24odil7XHJcbiAgICAgICAgdihhcmcpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBzZW5kVGVzdE1zZzogZnVuY3Rpb24odHh0KSB7XHJcbiAgICBfc29ja2V0LnNlbmQodHh0KTtcclxuICB9XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBXUzsiLCIvKipcclxuICogQ3JlYXRlZCBieSB0b3Mgb24gMDguMTEuMjAxNS5cclxuICovXHJcblxyXG5sZXQgQ2hhdEludGVyZmFjZSA9IHJlcXVpcmUoJy4uL2NoYXQvaW50ZXJmYWNlJyk7XHJcblxyXG5sZXQgU0NoYXRBY3Rpb25zID0gcmVxdWlyZSgnLi4vYWN0aW9ucy9TQ2hhdEFjdGlvbnMnKSxcclxuICAgIFNDaGF0VXNlcnNTdG9yZSA9IHJlcXVpcmUoJy4uL3N0b3Jlcy9TQ2hhdFVzZXJzU3RvcmUnKSxcclxuICAgIFNDaGF0U2VjdGlvbnNTdG9yZSA9IHJlcXVpcmUoJy4uL3N0b3Jlcy9TQ2hhdFNlY3Rpb25zU3RvcmUnKTtcclxuXHJcblNDaGF0VXNlcnNTdG9yZS5hZGRDaGFuZ2VMaXN0ZW5lcihmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnQ29tcG9uZW50IHJldHJpZXZlIGRhdGEgZnJvbSBzdG9yZScpO1xyXG59KTtcclxuXHJcblNDaGF0U2VjdGlvbnNTdG9yZS5hZGRDaGFuZ2VMaXN0ZW5lcihmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnZjpTQ2hhdENvbXBvbmVudCA+IEFjdGl2YXRlIHNlY3Rpb246ICcsIFNDaGF0U2VjdGlvbnNTdG9yZS5nZXRBY3RpdmVTZWN0aW9uKCkpO1xyXG4gICAgQ2hhdEludGVyZmFjZS5zaG93U2VjdGlvbihTQ2hhdFNlY3Rpb25zU3RvcmUuZ2V0QWN0aXZlU2VjdGlvbigpKTtcclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgIFNDaGF0QWN0aW9ucy51cGRhdGVMaXN0T2ZVc2VycyhbJ3VzZXIxJywndXNlcjInXSk7XHJcbn0sMjAwMCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgdG9zIG9uIDA4LjExLjIwMTUuXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24ga2V5TWlycm9yKG9iaikge1xyXG4gICAgZm9yIChsZXQga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgb2JqW2tleV0gPSBrZXk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb2JqO1xyXG59XHJcblxyXG5sZXQgU0NoYXRDb25zdGFudHMgPSBrZXlNaXJyb3Ioe1xyXG4gICAgQ09OTl9PUEVOOiBudWxsLFxyXG4gICAgQVVUSE9SSVpFRDogbnVsbCxcclxuICAgIFVQREFURV9VU0VSU19MSVNUOiBudWxsXHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBTQ2hhdENvbnN0YW50czsiLCIvKipcclxuICogQ3JlYXRlZCBieSB0b3Mgb24gMDguMTEuMjAxNS5cclxuICovXHJcblxyXG5sZXQgX2NhbGxiYWNrcyA9IFtdO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICByZWdpc3RlcjogZnVuY3Rpb24oY2FsbGJhY2spe1xyXG4gICAgICAgIF9jYWxsYmFja3MucHVzaChjYWxsYmFjayk7XHJcbiAgICB9LFxyXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKGFjdGlvbil7XHJcbiAgICAgICAgX2NhbGxiYWNrcy5tYXAoZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgdihhY3Rpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59OyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHRvcyBvbiAwOC4xMS4yMDE1LlxyXG4gKi9cclxuXHJcblxyXG5sZXQgU0NoYXREaXNwYXRjaGVyID0gcmVxdWlyZSgnLi4vZGlzcGF0Y2hlci9TQ2hhdERpc3BhdGNoZXInKSxcclxuICAgIFNDaGF0Q29uc3RhbnRzID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzL1NDaGF0Q29uc3RhbnRzJyksXHJcbiAgICBFbWl0dGVyID0gcmVxdWlyZSgnLi9lbWl0ZXInKTtcclxuXHJcbmNvbnN0ICAgQ0hBTkdFX0VWRU5UID0gJ2NoYW5nZScsXHJcbiAgICAgICAgU0VDVElPTl9MT0dJTiA9ICdsb2dpbicsXHJcbiAgICAgICAgU0VDVElPTl9DSEFUID0gJ2NoYXQnO1xyXG5cclxubGV0IF9zZWN0aW9ucyA9IHtcclxuICAgIFNFQ1RJT05fTE9HSU46IGZhbHNlLFxyXG4gICAgU0VDVElPTl9DSEFUOiBmYWxzZVxyXG59O1xyXG5cclxuZnVuY3Rpb24gYWN0aXZhdGVTZWN0aW9uKHNlY3Rpb24pIHtcclxuICAgIGZvciAobGV0IGtleSBpbiBfc2VjdGlvbnMpIHtcclxuICAgICAgICBpZiAoX3NlY3Rpb25zLmhhc093blByb3BlcnR5KGtleSkpIF9zZWN0aW9uc1trZXldID0gZmFsc2U7XHJcbiAgICAgICAgX3NlY3Rpb25zW3NlY3Rpb25dID0gdHJ1ZTtcclxuICAgIH1cclxufVxyXG5cclxubGV0IFNDaGF0U2VjdGlvbnNTdG9yZSA9IE9iamVjdC5hc3NpZ24oe30sIEVtaXR0ZXIucHJvdG90eXBlLCB7XHJcbiAgICBhZGRDaGFuZ2VMaXN0ZW5lcjogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmFkZE15TGlzdGVuZXIoQ0hBTkdFX0VWRU5ULCBjYWxsYmFjayk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldEFjdGl2ZVNlY3Rpb246IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIF9zZWN0aW9ucykge1xyXG4gICAgICAgICAgICBpZiAoX3NlY3Rpb25zLmhhc093blByb3BlcnR5KGtleSkgJiYgX3NlY3Rpb25zW2tleV0pIHJldHVybiBrZXk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuXHJcblNDaGF0RGlzcGF0Y2hlci5yZWdpc3RlcihmdW5jdGlvbihhY3Rpb24pe1xyXG4gICAgY29uc29sZS5sb2coJ0RJU1BBVENIRVIgcmVnaXN0ZXJlZCBpbiBTQ2hhdFNlY3Rpb25zU3RvcmUnKTtcclxuICAgIHN3aXRjaCAoYWN0aW9uLmFjdGlvblR5cGUpIHtcclxuICAgICAgICBjYXNlIFNDaGF0Q29uc3RhbnRzLkNPTk5fT1BFTjpcclxuICAgICAgICAgICAgYWN0aXZhdGVTZWN0aW9uKFNFQ1RJT05fTE9HSU4pO1xyXG4gICAgICAgICAgICBTQ2hhdFNlY3Rpb25zU3RvcmUuZW1pdChDSEFOR0VfRVZFTlQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFNDaGF0Q29uc3RhbnRzLkFVVEhPUklaRUQ6XHJcbiAgICAgICAgICAgIGFjdGl2YXRlU2VjdGlvbihTRUNUSU9OX0NIQVQpO1xyXG4gICAgICAgICAgICBTQ2hhdFNlY3Rpb25zU3RvcmUuZW1pdChDSEFOR0VfRVZFTlQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgIC8vbm90aGluZ1xyXG4gICAgfVxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gU0NoYXRTZWN0aW9uc1N0b3JlOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHRvcyBvbiAwOC4xMS4yMDE1LlxyXG4gKi9cclxuXHJcbmxldCBTQ2hhdERpc3BhdGNoZXIgPSByZXF1aXJlKCcuLi9kaXNwYXRjaGVyL1NDaGF0RGlzcGF0Y2hlcicpLFxyXG4gICAgU0NoYXRDb25zdGFudHMgPSByZXF1aXJlKCcuLi9jb25zdGFudHMvU0NoYXRDb25zdGFudHMnKSxcclxuICAgIEVtaXR0ZXIgPSByZXF1aXJlKCcuL2VtaXRlcicpO1xyXG5cclxuY29uc3QgQ0hBTkdFX0VWRU5UID0gJ2NoYW5nZSc7XHJcbmxldCBfdXNlcnMgPSBbXTtcclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVVzZXJzKG5ld1VzZXJzKSB7XHJcbiAgICBfdXNlcnMgPSBuZXdVc2VycztcclxufVxyXG5cclxubGV0IFNDaGF0VXNlcnNTdG9yZSA9IE9iamVjdC5hc3NpZ24oe30sIEVtaXR0ZXIucHJvdG90eXBlLCB7XHJcbiAgICBhZGRDaGFuZ2VMaXN0ZW5lcjogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmFkZE15TGlzdGVuZXIoQ0hBTkdFX0VWRU5ULCBjYWxsYmFjayk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuU0NoYXREaXNwYXRjaGVyLnJlZ2lzdGVyKGZ1bmN0aW9uKGFjdGlvbil7XHJcbiAgICBjb25zb2xlLmxvZygnRElTUEFUQ0hFUiByZWdpc3RlcmVkIGluIFNDaGF0VXNlcnNTdG9yZScpO1xyXG4gICAgc3dpdGNoIChhY3Rpb24uYWN0aW9uVHlwZSkge1xyXG4gICAgICAgIGNhc2UgU0NoYXRDb25zdGFudHMuQUNUSVZBVEVfTE9HSU5fRk9STTpcclxuICAgICAgICAgICAgLy9TQ2hhdFVzZXJzU3RvcmUuZW1pdChDSEFOR0VfRVZFTlQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvL25vdGhpbmdcclxuICAgIH1cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNDaGF0VXNlcnNTdG9yZTsiLCIvKipcclxuICogQ3JlYXRlZCBieSB0b3Mgb24gMDguMTEuMjAxNS5cclxuICovXHJcblxyXG5sZXQgRW1pdHRlciA9IGZ1bmN0aW9uKCkge1xyXG59O1xyXG5cclxuRW1pdHRlci5wcm90b3R5cGUuYWRkTXlMaXN0ZW5lciA9IGZ1bmN0aW9uKGV2ZW50LGxpc3RlbmVyKSB7XHJcbiAgICBpZiAoIXRoaXMuX2V2ZW50cykgdGhpcy5fZXZlbnRzID0ge307XHJcbiAgICBpZiAoIXRoaXMuX2V2ZW50cy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHRoaXMuX2V2ZW50c1tldmVudF0gPSBbXTtcclxuICAgIHRoaXMuX2V2ZW50c1tldmVudF0ucHVzaChsaXN0ZW5lcik7XHJcbn07XHJcblxyXG5FbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24oZXZlbnQsIGFyZykge1xyXG4gICAgaWYgKHRoaXMuX2V2ZW50cyAmJiB0aGlzLl9ldmVudHMuaGFzT3duUHJvcGVydHkoZXZlbnQpKSB7XHJcbiAgICAgICAgdGhpcy5fZXZlbnRzW2V2ZW50XS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICB2KGFyZyk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRW1pdHRlcjsiXX0=
